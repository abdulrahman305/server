"use strict";(self.webpackChunknextcloud=self.webpackChunknextcloud||[]).push([[4329],{17859:(e,t,a)=>{a.d(t,{A:()=>n._});var n=a(66980)},24329:(e,t,a)=>{a.r(t),a.d(t,{default:()=>y});var n=a(20641),s=a(50953),i=a(90033),r=a(61884);class l{static GLOBAL_SCOPE_VOLATILE="nextcloud_vol";static GLOBAL_SCOPE_PERSISTENT="nextcloud_per";scope;wrapped;constructor(e,t,a){this.scope=`${a?l.GLOBAL_SCOPE_PERSISTENT:l.GLOBAL_SCOPE_VOLATILE}_${btoa(e)}_`,this.wrapped=t}scopeKey(e){return`${this.scope}${e}`}setItem(e,t){this.wrapped.setItem(this.scopeKey(e),t)}getItem(e){return this.wrapped.getItem(this.scopeKey(e))}removeItem(e){this.wrapped.removeItem(this.scopeKey(e))}clear(){Object.keys(this.wrapped).filter(e=>e.startsWith(this.scope)).map(this.wrapped.removeItem.bind(this.wrapped))}}class o{appId;persisted=!1;clearedOnLogout=!1;constructor(e){this.appId=e}persist(e=!0){return this.persisted=e,this}clearOnLogout(e=!0){return this.clearedOnLogout=e,this}build(){return new l(this.appId,this.persisted?window.localStorage:window.sessionStorage,!this.clearedOnLogout)}}var u=a(91126),c=a(64572),p=a(17859),d=a(61292),m=a(35810),h=a(50240);function v(e){if(""===e.trim())return(0,d.t)("Names must not be empty.");if(e.startsWith("."))return(0,d.t)("Names must not start with a dot.");if(e.length>64)return(0,d.t)("Names may be at most 64 characters long.");try{return(0,m.KT)(e),""}catch(e){if(!(e instanceof m.di))throw e;switch(e.reason){case m.nF.Character:return(0,d.t)('"{char}" is not allowed inside a name.',{char:e.segment});case m.nF.ReservedName:return(0,d.t)('"{segment}" is a reserved name and not allowed.',{segment:e.segment});case m.nF.Extension:return e.segment.match(/\.[a-z]/i)?(0,d.t)('"{extension}" is not an allowed name.',{extension:e.segment}):(0,d.t)('Names must not end with "{extension}".',{extension:e.segment});default:return(0,d.t)("Invalid name.")}}}const b={key:0,class:"public-auth-prompt__text"},f=(0,n.pM)({__name:"PublicAuthPrompt",props:{nickname:{default:""},title:{default:(0,d.t)("Guest identification")},text:{default:""},notice:{default:""},submitLabel:{default:(0,d.t)("Submit name")},cancellable:{type:Boolean}},emits:["close"],setup(e,{emit:t}){const a=e,l=t,m=(0,n.rk)("input"),h=new o("public").build();const f=(0,s.KR)(a.nickname);(0,n.wB)(()=>a.nickname,()=>{f.value=a.nickname}),(0,n.wB)(f,e=>{const t=v(e);if(!t)return m.value.setCustomValidity(t),m.value.reportValidity(),void m.value.focus()});const y=(0,n.EW)(()=>{const e={label:(0,d.t)("Cancel"),variant:"tertiary",callback:()=>l("close")},t={label:a.submitLabel,type:"submit",variant:"primary"};return a.cancellable?[e,t]:[t]}),w=(0,n.EW)(()=>a.notice?a.notice:f.value?(0,d.t)("You are currently identified as {nickname}.",{nickname:f.value}):(0,d.t)("You are currently not identified."));function _(){const e=f.value.trim(),t=v(e);if(t)return m.value.setCustomValidity(t),m.value.reportValidity(),void m.value.focus();if(""===e)return m.value.setCustomValidity((0,d.t)("You cannot leave the name empty.")),m.value.reportValidity(),void m.value.focus();if(e.length<2)return m.value.setCustomValidity((0,d.t)("Please enter a name with at least 2 characters.")),m.value.reportValidity(),void m.value.focus();try{(0,r.L$)(e)}catch(e){return d.l.error("Failed to set nickname",{error:e}),(0,d.s)((0,d.t)("Failed to set nickname.")),void m.value.focus()}h.setItem("public-auth-prompt-shown","true"),l("close",f.value)}return(t,a)=>((0,n.uX)(),(0,n.Wv)((0,s.R1)(u.A),{buttons:y.value,class:"public-auth-prompt","data-cy-public-auth-prompt-dialog":"","is-form":"","no-close":"",name:e.title,onSubmit:_},{default:(0,n.k6)(()=>[e.text?((0,n.uX)(),(0,n.CE)("p",b,(0,i.v_)(e.text),1)):(0,n.Q3)("",!0),(0,n.bF)((0,s.R1)(c.A),{class:"public-auth-prompt__header",text:w.value,type:"info"},null,8,["text"]),(0,n.bF)((0,s.R1)(p.A),{ref:"input",modelValue:f.value,"onUpdate:modelValue":a[0]||(a[0]=e=>f.value=e),class:"public-auth-prompt__input","data-cy-public-auth-prompt-dialog-name":"",label:(0,s.R1)(d.t)("Name"),placeholder:(0,s.R1)(d.t)("Enter your name"),required:!e.cancellable,minlength:"2",maxlength:"64",name:"name"},null,8,["modelValue","label","placeholder","required"])]),_:1},8,["buttons","name"]))}}),y=(0,h._)(f,[["__scopeId","data-v-b33d88e5"]])}}]);
//# sourceMappingURL=4329-4329.js.map?v=ec4121591b99585a2df6